# Development Guidelines

## API Calls

**IMPORTANT: Do NOT use JavaScript to make API calls to the backend.**

All API calls should be made server-side using C# Razor Pages with proper form postback handling. This ensures:
- Better security (no exposed tokens in client-side code)
- Proper server-side validation
- Clean separation of concerns
- Standard HTTP form handling

### Example Pattern:

1. **PageModel (SetUsername.cshtml.cs)**:
   - Use `[BindProperty]` for form fields
   - Handle POST with `OnPostAsync()` method
   - Call backend via `BackendClient` service
   - Return `RedirectToPage()` on success or `Page()` with error message on failure

2. **View (SetUsername.cshtml)**:
   - Use `method="post"` on forms
   - Use `asp-for` for input binding
   - Display `Model.ErrorMessage` for validation errors

3. **JavaScript (minimal)**:
   - Only use for client-side enhancements (Firebase auth check, UI interactions)
   - Do NOT make fetch/axios calls to backend APIs
   - Populate hidden fields for server-side processing

### Benefits:
- Cookies for session management (secure, HttpOnly for tokens)
- Server-side validation
- No CORS issues
- Better error handling
- Standard HTML form behavior
